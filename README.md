# BookApi - Магазин книг (Web API)

Это Web API приложение для магазина книг, разработанное на .NET Core 3.1+ с использованием Entity Framework Core и паттерна Repository.

## Возможности

*   Получение списка книг с фильтрацией по названию и дате публикации.
*   Получение полной информации о книге по ID.
*   Сохранение нового заказа (один заказ может содержать несколько книг).
*   Получение списка заказов с фильтрацией по номеру и дате заказа.
*   Общая обработка исключений с помощью пользовательского Middleware.
*   Разделение между Entity и Models.

## Структура проекта

Проект организован по слоям для лучшей поддерживаемости и разделения ответственности:

*   `Controllers`: Обработка HTTP-запросов и ответов, делегирование бизнес-логики сервисам.
*   `Models`: Объекты передачи данных (DTO) для взаимодействия с API.
*   `Entities`: Сущности базы данных (Book, Order, OrderItem).
*   `Data`: Контекст базы данных, конфигурация EF Core и класс для инициализации тестовых данных.
*   `Repositories`: Паттерн репозитория для абстрагирования доступа к данным.
*   `Services`: Содержит бизнес-логику приложения.
*   `Middleware`: Пользовательские промежуточные ПО, такие как обработка исключений.
*   `Configuration`: Настройка AutoMapper.

## Запуск проекта

### Предварительные требования

*   .NET Core SDK 3.1+
*   SQL Server LocalDB

### Шаги запуска

1.  **Клонируйте репозиторий**:
    ```bash
    git clone <URL_репозитория>
    cd BookApi
    ```

2.  **Восстановите зависимости и обновите инструменты EF Core (если необходимо)**:
    ```bash
    dotnet restore
    ```

3.  **Создайте и примените миграции, а также заполните базу данных тестовыми данными**:
    *   `appsettings.json` содержит строку подключения к SQL Server LocalDB.
    *   `SeedData.Initialize` будет запущен автоматически при запуске приложения в режиме разработки, заполняя БД тестовыми книгами и заказами.
    ```bash
    dotnet ef database update
    ```

4.  **Запустите приложение**:
    ```bash
    dotnet run
    ```

    После запуска в консоли вы увидите URL-адрес, по которому доступно ваше приложение.

## Endpoints

После запуска приложения вы можете получить доступ к интерактивной документации Swagger UI по адресу: `https://localhost:XXXX/swagger`.

### Книги (Books)

| Метод | Путь                    | Описание                                  | Параметры запроса |
| :---- | :---------------------- | :---------------------------------------- | :--------------------------------- |
| `GET` | `/api/books/`            | Получить все книги.                       |-               |
| `GET` | `/api/books/filter`            | Получить все книги (фильтр).                       | `title` (string), `publicationDate` (datetime) |
| `GET` | `/api/books/{id}`       | Получить книгу по ID.                     | -                                  |
| `POST`| `/api/books`            | Добавить новую книгу.                     | -                                  |
| `PUT` | `/api/books/{id}`       | Обновить существующую книгу по ID.       | -                                  |
| `DELETE`| `/api/books/{id}`     | Удалить книгу по ID.                      | -                                  |

### Заказы (Orders)

| Метод | Путь                    | Описание                                  | Параметры запроса|
| :---- | :---------------------- | :---------------------------------------- | :--------------------------------- |
| `GET` | `/api/orders`           | Получить все заказы.                      |- | 
| `GET` | `/api/orders/filter`           | Получить все заказы (фильтр).                      | `orderId` (int), `orderDate` (datetime) |
| `GET` | `/api/orders/{id}`      | Получить заказ по ID (с деталями).        | -                                  |
| `POST`| `/api/orders`           | Создать новый заказ.                      | -                                  |